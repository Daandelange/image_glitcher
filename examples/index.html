<!DOCTYPE HTML>
<html lang="en-US" dir="ltr">
	<head>
		<meta charset="UTF-8">
		<title>Image Glitcher Demo</title>
		<meta name="author" content="Daan de Lange">
		<meta name="generator" content="Coda.app">
		<meta name="rating" content="general">
		<meta name="robots" content="Index,Follow,noarchive,noimageindex">
		<meta name="googlebot" content="noarchive,noimageindex">
		<style>
			/*CSS Reset*/body, div, dl, dt, dd, li, pre,form, fieldset, input, textarea, p, blockquote, th, td, button { margin: 0; padding: 0; }h1, h2, h3, h4, h5, h6 { margin: 0; padding: 0; font-size: 100%; font-weight: normal; }address, caption, cite, code, dfn, em, strong, var { font-style: normal; font-weight: normal; }ol, ul { list-style: none; margin: 0; padding: 0; }table { border-collapse: collapse; border-spacing: 0; } caption, th { text-align: left; font-weight: normal; font-style: normal; }acronym, abbr, fieldset, img { border: 0;}:focus { outline: 0; }
			
			body {
				background-color: white;
				font-size: 15px;
			}
			h1 {
				font-weight: bold;
				font-size: 1.8em;
			}
			h2, h3, h4, h5, h6 {
				font-weight: bold;
				font-size: 1.6em;
				margin-top: 2em;
			}
			.wrapper {
				width: 500px;
				margin: 0 auto;
				padding: 50px 10px;
			}
			
			.wrapper p {
				text-align: justify;
			}
			
			.wrapper ul {
				padding-left: 1em;
				list-style: disc;
			}
			
			.wrapper img {
				margin: 1em 0 1em;
			}
			
			.glitched_image {
				position: absolute;
			}
		</style>
	</head>
	<body>
		<div class="wrapper">
			<h1>A Clone of My Own</h1>
			<p>Interesting. No, wait, the other thing: tedious. That could be 'my' beautiful soul sitting naked on a couch. If I could just learn to play this stupid thing. Tell them I hate them. No! The cat shelter's on to me. <br>
			<img src="images/city-11087_640.jpg" alt="city-11087_640" width="500" height="349">
			<!- http://pixabay.com/en/city-building-night-view-night-11087/ -></p>
			<h2>Parasites Lost</h2>
			<p>Does anybody else feel jealous and aroused and worried? Does anybody else feel jealous and aroused and worried? Ah, the 'Breakfast Club' soundtrack!  I can't wait til I'm old enough to feel ways about stuff! We're rescuing ya. Alright, let's mafia things up a bit. Joey, burn down the ship. Clamps, burn down the crew.<br>
			<img src="images/astronaut-11080_640.jpg" alt="astronaut-11080_640" width="500" height="340">
			<!- http://pixabay.com/en/astronaut-space-shuttle-discovery-11080/ ->
			</p>
			<ul>
			<li>Hello Morbo, how's the family?</li>
			<li>But I know you in the future. I cleaned your poop.</li>
			<li>I don't know what you did, Fry, but once again, you screwed up! Now all the planets are gonna start cracking wise about our mamas.</li>
			</ul>
			<h3>Love and Rocket</h3>
			<p>And so we say goodbye to our beloved pet, Nibbler, who's gone to a place where I, too, hope one day to go. The toilet. Stop it, stop it. It's fine. I will 'destroy' you! Hello Morbo, how's the family? We're rescuing ya.<br>
			<img src="images/el-capitan-3768_640.jpg" alt="el-capitan-3768_640" width="500" height="375">
			<!- http://pixabay.com/en/el-capitan-yosemite-valley-usa-3768/ ->
			</p>
			<h4>Fear of a Bot Planet</h4>
			<p>Oh, you're a dollar naughtier than most. Negative, bossy meat creature! OK, this has gotta stop. I'm going to remind Fry of his humanity the way only a woman can. Maybe I love you so much I love you no matter who you are pretending to be. Hi, I'm a naughty nurse, and I really need someone to talk to. $9.95 a minute. OK, if everyone's finished being stupid.<br>
			<img src="images/machu-picchu-43387_640.jpg" alt="machu-picchu-43387_640" width="500" height="375">
			<!-  ->
			</p>
			<ul>
			<li>Five hours? Aw, man! Couldn't you just get me the death penalty?</li>
			<li>Soon enough.</li>
			<li>You mean while I'm sleeping in it?</li>
			<li>Large bet on myself in round one.</li>
			</ul>
			<h5>The Day The Earth Stood Stupid</h5>
			<p>Whoa a real live robot; or is that some kind of cheesy New Year's costume? You, minion. Lift my arm. AFTER HIM! Would you censor the Venus de Venus just because you can see her spewers? Uh, is the puppy mechanical in any way?<br>
			<img src="images/pomegranate-11871_640.jpg" alt="pomegranate-11871_640" width="500" height="375">
			<!- http://pixabay.com/en/pomegranate-grenadine-red-fruit-11871/ ->
			</p>
			<h6>A Head in the Polls</h6>
			<p>Why not indeed! No! Don't jump! I videotape every customer that comes in here, so that I may blackmail them later. You know, I was God once. Quite possible. We live long and are celebrated poopers.</p>
			<p>Who am I making this out to? Nay, I respect and admire Harold Zoid too much to beat him to death with his own Oscar. Actually, that's still true. But I know you in the future. I cleaned your poop. Oh, but you can. But you may have to metaphorically make a deal with the devil.  And by "devil", I mean Robot Devil.  And by "metaphorically", I mean get your coat.<br>
			<img src="images/sun-19814_640.jpg" alt="sun-19814_640" width="500" height="375">
			<!- http://pixabay.com/en/sun-set-sunset-fire-sea-ocean-19814/ ->
			</p>
			<p>You mean while I'm sleeping in it? Well I'da done better, but it's plum hard pleading a case while awaiting trial for that there incompetence. I wish! It's a nickel. You don't know how to do any of those. Who am I making this out to?</p>
			<p>Stop! Don't shoot fire stick in space canoe! Cause explosive decompression! Ugh, it's filthy! Why not create a National Endowment for Strip Clubs while we're at it? Perhaps, but perhaps your civilization is merely the sewer of an even greater society above you! I decline the title of Iron Cook and accept the lesser title of Zinc Saucier, which I just made up. Uhh&hellip; also, comes with double prize money.<br>
			<img src="images/tree-99852_640.jpg" alt="tree-99852_640" width="500" height="331">
			<!- http://pixabay.com/en/tree-fall-fall-colors-fall-leaves-99852/ ->
			</p>
			<p>I don't know what you did, Fry, but once again, you screwed up! Now all the planets are gonna start cracking wise about our mamas. Ok, we'll go deliver this crate like professionals, and then we'll go ride the bumper cars. You won't have time for sleeping, soldier, not with all the bed making you'll be doing.</p>
		</div>
		<script type="text/javascript" src="js/processing.js"></script>
		<script type="text/javascript" src="js/jquery.min.js"></script>
		<script type="text/javascript" src="js/jquery.unevent.js"></script>
		<script type="text/javascript">
			
			$(function(){
				$("img").each(function(){
					var c = $("<canvas>").addClass('glitched_image')
							// copy img style elements
							.height($(this).height())
							.width($(this).width())
							.css({marginLeft: $(this).css('marginLeft'), marginTop: $(this).css('marginTop')})
							//.attr('data-processing-sources', 'glitchMe.pde')
							.attr({'data-height': $(this).height(), 'data-width': $(this).width(), 'data-img': $(this).attr('src')});
					$(this).before(c);
					
					// load the pjs glitch code on the canvas
					// pjs will also give it a unique ID
					Processing.loadSketchFromSources(c[0], ["glitchMe.pde"]);
					// processing then calls a the JS function pjs_ready() to set the 
				});
			
				$(document).on('scroll', function(){
					$("img").css('opacity', 0).prev("canvas.glitched_image").css('opacity', 1);
				}),
				$(document).on('scroll', function(){
					clean_images();
					$("img").each(function(){
						$(this).css('opacity', 1).prev("canvas.glitched_image").css('opacity', 0);
						var processingInstance = Processing.getInstanceById( $(this).prev("canvas.glitched_image").attr("id") );
						processingInstance.draw();
					});
					
					
				}, 150);
			});
			
			var pjs_ready = function(instance){
				if(typeof instance == "object"){
					var c = $(instance);
					
					// get pjs instance of the canvas
					var processingInstance = Processing.getInstanceById(c.attr('id'));
					
					// set the correct size now that pjs has initiated
					processingInstance.size($(c).attr('data-width'), $(c).attr('data-height'));
					
					// fill the canvas with our image
					var context = c[0].getContext('2d');
					var imageObj = new Image();
					
					imageObj.onload = function() {
						context.drawImage(imageObj, 0, 0, $(c).attr('data-width'), $(c).attr('data-height'));
					};
					imageObj.src = $(c).attr('data-img');
				}
			}
			
			var clean_images = function(){
				console.log
				$("canvas.glitched_image").each(function(){
					// fill the canvas with our image
					var context = this.getContext('2d');
					var imageObj = new Image();
					
					imageObj.onload = function() {
					    context.drawImage(imageObj, 0, 0, $(this).attr('data-width'), $(this).attr('data-height'));
					};
					imageObj.src = $(this).attr('data-img');
				});
			}
		</script>
	</body>
</html>